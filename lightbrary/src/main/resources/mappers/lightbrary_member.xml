<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
 "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.lightbrary.member">
	
	<resultMap type="com.lightbrary.member.model.MemberDto" id="memberResultMap">
		<id column="NO" property="no"/>
		<result column="GRADE_CODE" property="gradeCode"/>
		<result column="EMAIL" property="email"/>
		<result column="PASSWORD" property="password"/>
		<result column="NAME" property="name"/>
		<result column="PHONE" property="phone"/>
		<result column="ADDRESS" property="address"/>
		<result column="CREATED_DATE" property="createdDate"
			javaType="java.util.Date"/>
		<result column="MODIFIED_DATE" property="modifiedDate"
			javaType="java.util.Date"/>
	</resultMap>
	
	<insert id="insertOneMember" parameterType="memberDto">
		<selectKey keyProperty="no" resultType="int" order="BEFORE">
			SELECT MEMBER_NO_SEQ.NEXTVAL FROM DUAL
		</selectKey>
		
		INSERT INTO MEMBER
		VALUE(NO
			, GRADE_CODE, NAME, PHONE
			, EMAIL, PASSWORD, ADDRESS)
		VALUES(MEMBER_NO_SEQ.NEXTVAL
			, 1, #{name}, #{phone}
			, #{email}, #{password}, #{address})

	</insert>
	
	<select id="checkEmail" parameterType="String" resultType="int">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE EMAIL = #{email}
	</select>
	
	<select id="memberExist" parameterType="map" 
		resultMap="memberResultMap">
		SELECT NO, GRADE_CODE, NAME, EMAIL, PHONE, ADDRESS, CREATED_DATE, PASSWORD
		FROM MEMBER
		WHERE EMAIL = #{email}
		AND PASSWORD = #{password}
	</select>
	
	<select id="findEmail" parameterType="map" 
		resultMap="memberResultMap">
		SELECT NO, EMAIL
		FROM MEMBER
		WHERE NAME = #{userName}
		AND PHONE = #{phone}
	</select>
	
	<select id="findPassword" parameterType="String" resultType="String">
		SELECT PASSWORD
		FROM MEMBER
		WHERE EMAIL = #{email}
	</select>

</mapper>




